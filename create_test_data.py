import os
import django
import random

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
django.setup()

from django.contrib.auth.models import User
from hikes.models import HikeRoute, PointOfInterest, Review

def create_test_data():
    # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    Review.objects.all().delete()
    PointOfInterest.objects.all().delete()
    HikeRoute.objects.all().delete()
    User.objects.filter(username__startswith='user').delete()
    
    print("üóëÔ∏è  –°—Ç–∞—Ä—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã")
    
    # –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    users = []
    for i in range(1, 4):
        user = User.objects.create_user(
            username=f'user{i}',
            email=f'user{i}@example.com',
            password='password123'
        )
        users.append(user)
        print(f'‚úÖ –°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user.username}')

    # –î–∞–Ω–Ω—ã–µ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤
    hikes_data = [
        {
            'title': '–ü–æ—Ö–æ–¥ –∫ –æ–∑–µ—Ä—É –ì–æ—Ä–Ω–æ–µ',
            'description': '–ñ–∏–≤–æ–ø–∏—Å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç —á–µ—Ä–µ–∑ —Ö–≤–æ–π–Ω—ã–π –ª–µ—Å —Å –≤—ã—Ö–æ–¥–æ–º –∫ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–æ —á–∏—Å—Ç–æ–º—É –≥–æ—Ä–Ω–æ–º—É –æ–∑–µ—Ä—É. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ª–µ—Ç–Ω–µ–≥–æ –¥–Ω—è.',
            'length_km': 8.5,
            'estimated_time_h': 4,
            'difficulty': 'medium',
            'start_point_lat': 55.7558,
            'start_point_lon': 37.6173,
            'finish_point_lat': 55.7658,
            'finish_point_lon': 37.6273,
        },
        {
            'title': '–ü—Ä–æ–≥—É–ª–∫–∞ –∫ –í–æ–¥–æ–ø–∞–¥—É –†–∞–¥—É–∂–Ω—ã–π',
            'description': '–õ–µ–≥–∫–∞—è —Å–µ–º–µ–π–Ω–∞—è –ø—Ä–æ–≥—É–ª–∫–∞ –ø–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω–æ–π —Ç—Ä–æ–ø–µ. –í –∫–æ–Ω—Ü–µ –º–∞—Ä—à—Ä—É—Ç–∞ –∂–¥–µ—Ç –∫—Ä–∞—Å–∏–≤—ã–π –≤–æ–¥–æ–ø–∞–¥ –≤—ã—Å–æ—Ç–æ–π 15 –º–µ—Ç—Ä–æ–≤.',
            'length_km': 3.2,
            'estimated_time_h': 2,
            'difficulty': 'easy',
            'start_point_lat': 55.7358,
            'start_point_lon': 37.6073,
            'finish_point_lat': 55.7458,
            'finish_point_lon': 37.6173,
        },
        {
            'title': '–í–æ—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –Ω–∞ –ü–∏–∫ –û—Ä–ª–∏–Ω—ã–π',
            'description': '–°–ª–æ–∂–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö —Ç—É—Ä–∏—Å—Ç–æ–≤. –ö—Ä—É—Ç—ã–µ –ø–æ–¥—ä–µ–º—ã, —Å–∫–∞–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏, –Ω–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–∞—è –ø–∞–Ω–æ—Ä–∞–º–∞ –Ω–∞ –≤–µ—Ä—à–∏–Ω–µ.',
            'length_km': 15.7,
            'estimated_time_h': 8,
            'difficulty': 'hard',
            'start_point_lat': 55.7758,
            'start_point_lon': 37.6373,
            'finish_point_lat': 55.7958,
            'finish_point_lon': 37.6573,
        },
        {
            'title': '–û—Å–µ–Ω–Ω—è—è —Ç—Ä–æ–ø–∞ –ø–æ –∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫—É',
            'description': '–ú–∞—Ä—à—Ä—É—Ç —á–µ—Ä–µ–∑ –∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫ –æ—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∞—Å–∏–≤ –æ—Å–µ–Ω—å—é, –∫–æ–≥–¥–∞ –ª–∏—Å—Ç–≤–∞ –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –≤ –∑–æ–ª–æ—Ç—ã–µ –∏ –±–∞–≥—Ä—è–Ω—ã–µ —Ü–≤–µ—Ç–∞.',
            'length_km': 10.2,
            'estimated_time_h': 5,
            'difficulty': 'medium',
            'start_point_lat': 55.7158,
            'start_point_lon': 37.5973,
            'finish_point_lat': 55.7258,
            'finish_point_lon': 37.6073,
        },
    ]

    # –°–æ–∑–¥–∞–µ–º –º–∞—Ä—à—Ä—É—Ç—ã
    hikes = []
    for i, data in enumerate(hikes_data):
        hike = HikeRoute.objects.create(
            **data,
            author=users[0]  # –ü–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –∞–≤—Ç–æ—Ä –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
        )
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ —Å–ª—É—á–∞–π–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
        for user in random.sample(users, random.randint(1, 2)):
            hike.favorited_by.add(user)
        
        hikes.append(hike)
        print(f'‚úÖ –°–æ–∑–¥–∞–Ω –º–∞—Ä—à—Ä—É—Ç: {hike.title}')

    # –¢–æ—á–∫–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞
    points_data = [
        {'name': '–í–æ–¥–æ–ø–∞–¥ –†–∞–¥—É–∂–Ω—ã–π', 'type': 'waterfall', 'description': '–ö—Ä–∞—Å–∏–≤—ã–π –∫–∞—Å–∫–∞–¥–Ω—ã–π –≤–æ–¥–æ–ø–∞–¥, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–Ω–æ–≤–æ–¥–Ω—ã–π –≤–µ—Å–Ω–æ–π.'},
        {'name': '–°–º–æ—Ç—Ä–æ–≤–∞—è "–û—Ä–ª–∏–Ω–æ–µ –≥–Ω–µ–∑–¥–æ"', 'type': 'viewpoint', 'description': '–ü–∞–Ω–æ—Ä–∞–º–Ω—ã–π –≤–∏–¥ –Ω–∞ –¥–æ–ª–∏–Ω—É —Å –≤—ã—Å–æ—Ç—ã 200 –º–µ—Ç—Ä–æ–≤.'},
        {'name': '–ò—Å—Ç–æ—á–Ω–∏–∫ "–ñ–∏–≤–∞—è –≤–æ–¥–∞"', 'type': 'spring', 'description': '–†–æ–¥–Ω–∏–∫ —Å —á–∏—Å—Ç–µ–π—à–µ–π –ø–∏—Ç—å–µ–≤–æ–π –≤–æ–¥–æ–π.'},
        {'name': '–ö–µ–º–ø–∏–Ω–≥ "–õ–µ—Å–Ω–∞—è –ø–æ–ª—è–Ω–∞"', 'type': 'camping', 'description': '–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –ø–∞–ª–∞—Ç–æ–∫ —Å –∫–æ—Å—Ç—Ä–æ–≤–∏—â–µ–º.'},
        {'name': '–î—Ä–µ–≤–Ω–∏–π –¥—É–±-–≤–µ–ª–∏–∫–∞–Ω', 'type': 'monument', 'description': '–î—É–± –≤–æ–∑—Ä–∞—Å—Ç–æ–º –±–æ–ª–µ–µ 300 –ª–µ—Ç, –ø–∞–º—è—Ç–Ω–∏–∫ –ø—Ä–∏—Ä–æ–¥—ã.'},
    ]

    for point_data in points_data:
        point = PointOfInterest.objects.create(
            **point_data,
            coordinates_lat=55.7558 + random.uniform(-0.03, 0.03),
            coordinates_lon=37.6173 + random.uniform(-0.03, 0.03),
        )
        # –°–≤—è–∑—ã–≤–∞–µ–º —Å –º–∞—Ä—à—Ä—É—Ç–∞–º–∏
        point.routes.set(random.sample(hikes, random.randint(1, 3)))
        print(f'üìç –°–æ–∑–¥–∞–Ω–∞ —Ç–æ—á–∫–∞: {point.name}')

    # –û—Ç–∑—ã–≤—ã (—É –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ—Ç–∑—ã–≤ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç)
    review_texts = [
        '–û—Ç–ª–∏—á–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç! –í—Å–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–µ—Ä–Ω—É—Å—å.',
        '–ö—Ä–∞—Å–∏–≤—ã–µ –≤–∏–¥—ã, –Ω–æ –º–µ—Å—Ç–∞–º–∏ —Å–ª–æ–∂–Ω—ã–π –ø–æ–¥—ä–µ–º.',
        '–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Å–µ–º–µ–π–Ω–æ–π –ø—Ä–æ–≥—É–ª–∫–∏, –¥–µ—Ç—è–º –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å.',
        '–í–æ–¥–æ–ø–∞–¥ –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π! –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç –∫—Ä–∞—Å–æ—Ç—É.',
        '–°–ª–æ–∂–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç, –Ω–æ –æ–Ω–æ —Ç–æ–≥–æ —Å—Ç–æ–∏—Ç. –í–∏–¥ —Å–≤–µ—Ä—Ö—É –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–π.',
        '–û—Ç–ª–∏—á–Ω–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ.',
        '–ú–∞—Ä—à—Ä—É—Ç —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–º–µ—á–µ–Ω, –Ω–µ –∑–∞–±–ª—É–¥–∏–ª–∏—Å—å.',
        '–£—Ç–æ–º–∏—Ç–µ–ª—å–Ω–æ, –Ω–æ –≤–∏–¥—ã –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—Ç —É—Å—Ç–∞–ª–æ—Å—Ç—å.',
        '–†–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å–µ–º –ª—é–±–∏—Ç–µ–ª—è–º –ø—Ä–∏—Ä–æ–¥—ã.',
        '–õ—É—á—à–∏–π –º–∞—Ä—à—Ä—É—Ç –≤ —ç—Ç–æ–º —Å–µ–∑–æ–Ω–µ!',
    ]

    # –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ —Å–æ–∑–¥–∞–µ–º –æ—Ç–∑—ã–≤—ã –æ—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    for hike in hikes:
        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —ç—Ç–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞ (1-3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
        review_users = random.sample(users, random.randint(1, 3))
        
        for user in review_users:
            Review.objects.create(
                route=hike,
                user=user,
                rating=random.choice([4, 5, 5, 4, 3]),  # –ß–∞—â–µ —Ö–æ—Ä–æ—à–∏–µ –æ—Ü–µ–Ω–∫–∏
                text=random.choice(review_texts)
            )
        print(f'üí¨ –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–∑—ã–≤—ã –¥–ª—è: {hike.title} (–æ—Ç {len(review_users)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)')

    # –°–æ–∑–¥–∞–µ–º —Ç–∞–∫–∂–µ –∞–¥–º–∏–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    if not User.objects.filter(username='admin').exists():
        User.objects.create_superuser(
            username='admin',
            email='admin@example.com',
            password='admin123'
        )
        print('üëë –°–æ–∑–¥–∞–Ω —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å admin / admin123')

    print('\n' + '='*50)
    print('üéâ –¢–ï–°–¢–û–í–´–ï –î–ê–ù–ù–´–ï –£–°–ü–ï–®–ù–û –°–û–ó–î–ê–ù–´!')
    print(f'üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:')
    print(f'   üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {User.objects.count()}')
    print(f'   ü•æ –ú–∞—Ä—à—Ä—É—Ç–æ–≤: {HikeRoute.objects.count()}')
    print(f'   üìç –¢–æ—á–µ–∫ –∏–Ω—Ç–µ—Ä–µ—Å–∞: {PointOfInterest.objects.count()}')
    print(f'   üí¨ –û—Ç–∑—ã–≤–æ–≤: {Review.objects.count()}')
    print('='*50)
    print('\nüîë –î–ª—è –≤—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:')
    print('   –õ–æ–≥–∏–Ω: admin / –ü–∞—Ä–æ–ª—å: admin123')
    print('   –ò–ª–∏: user1 / –ü–∞—Ä–æ–ª—å: password123')

if __name__ == '__main__':
    create_test_data()